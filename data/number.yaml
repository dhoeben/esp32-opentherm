# -----------------------------------------------------------
# Number entity to send target temperature to boiler
# -----------------------------------------------------------

- platform: template
  name: "Boiler Target Temperature"
  id: boiler_target
  icon: mdi:thermostat
  unit_of_measurement: "°C"
  min_value: 10
  max_value: 80
  step: 0.5
  optimistic: true
  initial_value: 21.0
  on_value:
    - lambda: |-
        auto ot = opentherm::OpenThermComponent::get_singleton();
        if (ot != nullptr) {
          uint16_t raw = (uint16_t)(x * 256.0f);      // °C → F8.8
          uint32_t frame = ot->build_request(opentherm::WRITE_DATA, 0x11, raw);
          ot->send_frame(frame);
          ESP_LOGI("otgw", "Sent new setpoint %.1f°C to boiler", x);
        }
