binary_sensor:
  - platform: template
    id: ch_active
    name: "CH Active"
    device_id: ch
    icon: mdi:radiator
    entity_category: diagnostic
    web_server:
      sorting_group_id: sorting_diagnostic

  - platform: template
    id: dhw_active
    name: "DHW Active"
    device_id: dhw
    icon: mdi:water-boiler
    device_class: power
    entity_category: diagnostic
    web_server:
      sorting_group_id: sorting_diagnostic

  - platform: template
    name: "DHW Preheat Active"
    device_id: dhw
    id: dhw_preheat_active
    icon: "mdi:water-boiler"
    lambda: |-
      auto ot = opentherm::OpenThermComponent::get_singleton();
      return ot ? ot->dhw_.is_active() : false;
    entity_category: diagnostic
    web_server:
      sorting_group_id: sorting_diagnostic

  - platform: template
    id: boiler_flame
    name: "Boiler Flame"
    icon: mdi:fire
    entity_category: diagnostic
    web_server:
      sorting_group_id: sorting_diagnostic

  - platform: template
    id: boiler_fault
    name: "Boiler Fault"
    icon: mdi:alert-box
    device_class: problem
    entity_category: diagnostic
    web_server:
      sorting_group_id: sorting_diagnostic

  - platform: template
    id: comms_ok
    name: "OpenTherm Communication"
    entity_category: diagnostic
    device_class: connectivity
    icon: mdi:connection
    web_server:
      sorting_group_id: sorting_diagnostic

  - platform: template
    id: wifi_connected
    name: "WiFi"
    entity_category: diagnostic
    device_class: connectivity
    web_server:
      sorting_group_id: sorting_diagnostic

  - platform: template
    name: "Water Flow Detected"
    id: tap_flow
    device_id: dhw
    device_class: running
    entity_category: diagnostic
    icon: mdi:hand-water
    web_server:
      sorting_group_id: sorting_diagnostic
    lambda: |-
      auto ot = opentherm::OpenThermComponent::get_singleton();
      return ot ? ot->tap_flow() : false;