number:
  - platform: template
    name: "Boiler Target Temperature"
    id: boiler_target
    icon: mdi:thermostat
    unit_of_measurement: "°C"
    min_value: 10
    max_value: 80
    step: 1.0
    optimistic: true
    initial_value: 21.0
    on_value:
      - lambda: |-
          auto ot = opentherm::OpenThermComponent::get_singleton();
          if (ot != nullptr) {
            uint16_t raw = (uint16_t)(x * 256.0f);      // °C → F8.8
            uint32_t frame = ot->build_request(opentherm::WRITE_DATA, 0x11, raw);
            ot->send_frame(frame);
            ESP_LOGI("otgw", "Sent new setpoint %.1f°C to boiler", x);
          }

  - platform: template
    name: "DHW Eco Temperature"
    id: dhw_eco_temp
    min_value: 35
    max_value: 55
    step: 1.0
    restore_value: true
    optimistic: true
    unit_of_measurement: "°C"
    icon: mdi:leaf

    on_value:
      - lambda: |-
          opentherm::DHW::eco_temp_number = (esphome::number::Number *)&id(dhw_eco_temp);

  - platform: template
    name: "DHW Normal Temperature"
    id: dhw_normal_temp
    min_value: 40
    max_value: 65
    step: 1.0
    restore_value: true
    optimistic: true
    unit_of_measurement: "°C"
    icon: mdi:fire

    on_value:
      - lambda: |-
          opentherm::DHW::normal_temp_number = (esphome::number::Number *)&id(dhw_normal_temp);

  - platform: template
    name: "Boiler DHW Setpoint"
    id: dhw_setpoint
    min_value: 35
    max_value: 65
    step: 0.5
    unit_of_measurement: "°C"
    optimistic: true
    restore_value: true
    initial_value: 55
    on_value:
      - lambda: |-
          auto ot = opentherm::OpenThermComponent::get_singleton();
          if (ot == nullptr) return;
          uint16_t raw = (uint16_t)(x * 256.0f);
          uint32_t frame = opentherm::OpenThermComponent::build_request(
              opentherm::WRITE_DATA, 0x1B, raw);
          ot->send_frame(frame);
          ESP_LOGI("dhw", "Set DHW setpoint to %.1f°C", x);

  # Equitherm
  - platform: template
    name: "Equitherm N (Slope)"
    id: eq_n
    min_value: 0.1
    max_value: 1.5
    step: 0.05
    restore_value: true
    optimistic: true
    unit_of_measurement: ""
    icon: mdi:chart-line

  - platform: template
    name: "Equitherm K (Offset)"
    id: eq_k
    min_value: 0.0
    max_value: 10.0
    step: 0.5
    restore_value: true
    optimistic: true
    unit_of_measurement: ""
    icon: mdi:chart-bell-curve

  - platform: template
    name: "Equitherm T (Base)"
    id: eq_t
    min_value: -10.0
    max_value: 10.0
    step: 0.5
    restore_value: true
    optimistic: true
    unit_of_measurement: "°C"
    icon: mdi:thermometer-lines

  - platform: template
    name: "Equitherm Feedback Gain"
    id: eq_fb_gain
    min_value: 0.0
    max_value: 10.0
    step: 0.5
    restore_value: true
    optimistic: true
    unit_of_measurement: ""
    icon: mdi:amplifier


  # Max values
  - platform: template
    name: "Boiler Max Heating Temp"
    id: max_boiler_temp_heating
    min_value: 30
    max_value: 90
    step: 1
    unit_of_measurement: "°C"
    restore_value: true
    optimistic: true

  - platform: template
    name: "Boiler Max Water Temp"
    id: max_boiler_temp_water
    min_value: 30
    max_value: 90
    step: 1
    unit_of_measurement: "°C"
    restore_value: true
    optimistic: true

  # Climate entity
  - platform: template
    name: "Preset home Temperature"
    id: home_temp
    icon: mdi:home
    min_value: 15
    max_value: 25
    step: 0.5
    initial_value: 18.0
    unit_of_measurement: "°C"
    restore_value: true
    optimistic: true

  - platform: template
    name: "Preset comfort Temperature"
    id: comfort_temp
    icon: mdi:white-balance-sunny
    min_value: 18
    max_value: 25
    step: 0.5
    initial_value: 20
    unit_of_measurement: "°C"
    restore_value: true
    optimistic: true

  - platform: template
    name: "Preset eco Temperature"
    id: eco_temp
    icon: mdi:leaf
    min_value: 14
    max_value: 22
    step: 0.5
    initial_value: 15
    unit_of_measurement: "°C"
    restore_value: true
    optimistic: true

  - platform: template
    name: "Preset away Temperature"
    id: away_temp
    icon: mdi:home-export-outline
    min_value: 5
    max_value: 20
    step: 0.5
    initial_value: 12
    unit_of_measurement: "°C"
    restore_value: true
    optimistic: true
